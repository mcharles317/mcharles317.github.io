---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(tidyverse)
library(waffle)
install.packages("hoopR")
# You can install using the pacman package using the following code:
if (!requireNamespace('pacman', quietly = TRUE)){
  install.packages('pacman')
}
library(hoopR)
library(dplyr)
library(tidyverse)
library(cluster)

set.seed(1234)
```
```{r}
tictoc::tic()
progressr::with_progress({
  nba_team_box <- hoopR::load_nba_team_box(2016:2021)
})

tictoc::toc()
```

```{r}
nba_team_box_better <- nba_team_box %>%
  separate(three_point_field_goals_made_three_point_field_goals_attempted, c('three_point_makes', 'three_point_attempts'),"-") %>% 
  mutate(three_point_makes= as.numeric(three_point_makes), three_point_attempts= as.numeric(three_point_attempts ), total_rebounds= as.numeric(total_rebounds), total_turnovers =as.numeric(total_turnovers), points_in_paint= as.numeric(points_in_paint), assists= as.numeric(assists))
  

#Find correlations between a few keys stats to determine which relate the most. Then turn that data into a graph
  
NBA2022 <- nba_team_box_better %>% 
  filter(season == "2021") %>% 
  group_by (team_name) %>% 
summarize(avg_3pt = sum(three_point_makes)/sum(three_point_attempts)*100) %>% 
  arrange(desc(avg_3pt))
  
```
```{r}
Totals2021 <- nba_team_box_better %>% 
  filter(season == "2021") %>% 
  group_by (team_name) %>% 
  summarise(TotalRebounds = sum(total_rebounds),TotalTurnovers = sum(total_turnovers),PointsinPaint = sum(points_in_paint), ThreePointMakes = sum(three_point_makes), Assists = sum(assists)) 
  
```



```{r}
Turnovers <- nba_team_box_better %>% 
  filter(season == "2021") %>% 
  group_by (team_name) %>% 
  summarise(sum(total_turnovers))
  
```
```{r}
PIP <- nba_team_box_better %>% 
  filter(season == "2021") %>% 
  group_by (team_name) %>% 
  summarise(sum(points_in_paint))
```
```{r}
Assists <- nba_team_box_better %>% 
  filter(season == "2021") %>% 
  group_by (team_name) %>% 
  summarise(sum(assists))
```
```{r}
ThreePointMakes <- nba_team_box_better %>% 
  filter(season == "2021") %>% 
  group_by (team_name) %>% 
  summarise(sum(three_point_makes))
```


```{r}
TotalScale <- Totals2021 %>%
  select(TotalRebounds, TotalTurnovers, PointsinPaint, ThreePointMakes, Assists) %>%
  mutate_all(scale) %>%
  na.omit()
```
```{r}
{kmeans(TotalScale, 6, nstart = 3 )$tot.withinss
}
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.


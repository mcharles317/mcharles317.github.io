---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(tidyverse)
library(nflreadr)
library(tidyverse)
library(ggalt)
library(ggbeeswarm)
library(ggrepel)
```
```{r}
NFL<- load_pbp(
  seasons = most_recent_season(),
  file_type = getOption("nflreadr.prefer", default = "rds")
)
```

```{r}
NFLRosters<- load_rosters(
  seasons = most_recent_season(roster = TRUE),
  file_type = getOption("nflreadr.prefer", default = "rds")
)
```

```{r}
NFL <- NFL %>% mutate(across(where(is.numeric), ~ replace_na(., 0)))
```


```{r}
TE <- NFL %>% 
   filter(fantasy_player_name == "K.Pitts" | fantasy_player_name == "T.Conklin" )
```
```{r}
MyTEs <- NFL %>% 
filter(fantasy_player_id == "00-0036970" | fantasy_player_id == "00-0034270" ) %>% 
group_by(fantasy_player_id, fantasy_player_name) %>% 
  summarise(TotalReceivingYds = sum(receiving_yards), Avg_ReceivingYds = mean(receiving_yards), Total_AirYards= sum(air_yards), Avg_AirYards= mean(air_yards), Avg__YAC = mean (yards_after_catch), Total_YAC = sum (yards_after_catch), Avg_AirEPA = mean (air_epa), Total_AirEPA = sum(air_epa), Avg_YACEPA =mean (yac_epa), Total_YacEPA = sum(yac_epa), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_YAC_Comp = sum(comp_yac_epa), Avg_YAC_Comp = mean(comp_yac_epa), Total_YAC_WPA = sum(yac_wpa), Avg_YAC_WPA = mean(yac_wpa))
```


```{r}
MyQB <- NFL %>% 
  filter(passer_player_id == "00-0033077" | passer_player_id == "00-0029604")%>% 
  group_by(passer_player_id, name)%>% 
summarise(Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_pass_touchdown = sum (pass_touchdown), Total_complete_pass = sum(complete_pass), Total_Pass_attempt = sum(pass_attempt), Interceptions = sum(interception), TotalQBEPA =sum(qb_epa), Avg_QBEPA = mean(qb_epa), Avg_pass_oe = mean(pass_oe), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum(comp_air_epa), TotalDropbacks= sum (qb_dropback))
```


```{r}
QB_by_Week<- NFL%>% 
  filter(passer_player_id == "00-0033077" | passer_player_id == "00-0029604")%>% 
  group_by(passer_player_id, week, name)%>% 
summarise(Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_pass_touchdown = sum (pass_touchdown), Total_complete_pass = sum(complete_pass), Total_Pass_attempt = sum(pass_attempt), TotalQBEPA =sum(qb_epa), Avg_QBEPA = mean(qb_epa), Avg_pass_oe = mean(pass_oe), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum(comp_air_epa), TotalDropbacks= sum (qb_dropback), Interceptions = sum(interception))
```
```{r}
QB_Rushing <- NFL %>% 
  filter(fantasy_id == "00-0033077" | fantasy_id == "00-0029604") %>% 
  filter(rush_attempt == 1) %>% 
  mutate(rushing_yards = replace_na(rushing_yards, 0)) %>% 
  group_by(fantasy_id, name) %>% 
  summarise(TotalRushAttempts = sum(rush_attempt), TotalRushYards = sum(rushing_yards))
```
```{r}
QBOverall <- MyQB %>% 
  inner_join(QB_Rushing, by= "name")
```

```{r}
QB_Rushing_Weekly<- NFL %>% 
  filter(rusher == "D.Prescott" | rusher == "K.Cousins") %>% 
  group_by(rusher, name, week) %>% 
  summarise(TotalRushAttempts = sum(rush_attempt), TotalRushYards = sum(rushing_yards))
```
```{r}
QB_Overall_Weekly <- QB_by_Week %>% 
  inner_join(QB_Rushing_Weekly, by= "name")
```

```{r}
MyWR <- NFL %>% 
   filter(fantasy_player_id == "00-0033921" | fantasy_player_id == "00-0034764" | fantasy_player_id == "00-0036913" | fantasy_player_id == "00-0036963" | fantasy_player_id == "00-0036252") %>% 
  group_by(fantasy_player_id, fantasy_player_name) %>% 
  summarise (Total_AirYards= sum(air_yards), Avg_AirYards= mean(air_yards), Avg__YAC = mean (yards_after_catch), Total_YAC = sum (yards_after_catch), Avg_AirEPA = mean (air_epa), Total_AirEPA = sum(air_epa), Avg_YACEPA =mean (yac_epa), Total_YacEPA = sum(yac_epa), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_YAC_Comp = sum(comp_yac_epa), Avg_YAC_Comp = mean(comp_yac_epa), Total_YAC_WPA = sum(yac_wpa), Avg_YAC_WPA = mean(yac_wpa),TotalReceivingYds = sum(receiving_yards), Avg_ReceivingYds = mean(receiving_yards), TotalEPA = sum(epa), TotalExpectedYAC_EPA = sum (xyac_epa),AvgExpectedYAC_EPA = mean (xyac_epa))
```



```{r}
WR_Weekly <- NFL %>% 
   filter(fantasy_player_id == "00-0033921" | fantasy_player_id == "00-0034764" | fantasy_player_id == "00-0036913" | fantasy_player_id == "00-0036963" | fantasy_player_id == "00-0036252") %>% 
  group_by(fantasy_player_id, fantasy_player_name, week) %>% 
  summarise (Total_AirYards= sum(air_yards), Avg_AirYards= mean(air_yards), Avg__YAC = mean (yards_after_catch), Total_YAC = sum (yards_after_catch), Avg_AirEPA = mean (air_epa), Total_AirEPA = sum(air_epa), Avg_YACEPA =mean (yac_epa), Total_YacEPA = sum(yac_epa), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_YAC_Comp = sum(comp_yac_epa), Avg_YAC_Comp = mean(comp_yac_epa), Total_YAC_WPA = sum(yac_wpa), Avg_YAC_WPA = mean(yac_wpa), TotalEPA = sum(epa), TotalExpectedYAC_EPA = sum (xyac_epa),AvgExpectedYAC_EPA = mean (xyac_epa), TotalYardsGained = sum(yards_gained))
```
```{r}
WR_ThroughWeek4 <- NFL %>% 
   filter(fantasy_player_id == "00-0033921" | fantasy_player_id == "00-0034764" | fantasy_player_id == "00-0036913" | fantasy_player_id == "00-0036963" | fantasy_player_id == "00-0036252", week <= 4) %>% 
  group_by(fantasy_player_id, fantasy_player_name) %>% 
  summarise (Total_AirYards= sum(air_yards), Avg_AirYards= mean(air_yards), Avg__YAC = mean (yards_after_catch), Total_YAC = sum (yards_after_catch), Avg_AirEPA = mean (air_epa), Total_AirEPA = sum(air_epa), Avg_YACEPA =mean (yac_epa), Total_YacEPA = sum(yac_epa), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_YAC_Comp = sum(comp_yac_epa), Avg_YAC_Comp = mean(comp_yac_epa), Total_YAC_WPA = sum(yac_wpa), Avg_YAC_WPA = mean(yac_wpa), TotalEPA = sum(epa), TotalExpectedYAC_EPA = sum (xyac_epa),AvgExpectedYAC_EPA = mean (xyac_epa), TotalYardsGained = sum(yards_gained))
```






```{r}
MyRB_receiving<- NFL %>% 
  filter(fantasy_player_id == "00-0035685" | fantasy_player_id == "00-0036924" | fantasy_player_id == "00-0032144" | fantasy_player_id == "00-0037746" | fantasy_player_id == "00-0035831")%>% 
  group_by(fantasy_player_id, fantasy_player_name) %>% 
  summarise(TotalReceivingYds = sum(receiving_yards), Avg_ReceivingYds = mean(receiving_yards), Total_AirYards= sum(air_yards), Avg_AirYards= mean(air_yards), Avg__YAC = mean (yards_after_catch), Total_YAC = sum (yards_after_catch), Avg_AirEPA = mean (air_epa), Total_AirEPA = sum(air_epa), Avg_YACEPA =mean (yac_epa), Total_YacEPA = sum(yac_epa), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_YAC_Comp = sum(comp_yac_epa), Avg_YAC_Comp = mean(comp_yac_epa), Total_YAC_WPA = sum(yac_wpa), Avg_YAC_WPA = mean(yac_wpa), TotalEPA = sum(epa), TotalExpectedYAC_EPA = sum (xyac_epa),AvgExpectedYAC_EPA = mean (xyac_epa), TotalYardsGained = sum(yards_gained))
```

```{r}
MyRB<- NFL %>% 
  filter(fantasy_player_id == "00-0035685" | fantasy_player_id == "00-0036924" | fantasy_player_id == "00-0032144" | fantasy_player_id == "00-0037746" | fantasy_player_id == "00-0035831")%>% 
    filter(rush_attempt == 1) %>% 
  mutate(rushing_yards = replace_na(rushing_yards, 0)) %>% 
  group_by(fantasy_player_id, fantasy_player_name) %>% 
   summarise(TotalRushAttempts = sum(rush_attempt), TotalRushYards = sum(rushing_yards), YPC = TotalRushYards/TotalRushAttempts)
```
```{r}
RB_Overall <- MyRB%>% 
  inner_join(MyRB_receiving, by= "fantasy_player_name")
```

#Question:

```{r}
EveryWR<- NFLRosters %>% 
  filter(position == "WR") 
```


```{r}
EveryRB<- NFLRosters %>% 
  filter(position == "RB") 
```
```{r}
All_RB <- EveryRB %>% 
  inner_join(NFL, by=c("gsis_id" = "fantasy_player_id"))
```

```{r}
All_RB <- All_RB %>% 
    group_by(full_name, fantasy_data_id,position) %>% 
summarise(TotalRushAttempts = sum(rush_attempt), TotalRushYards = sum(rushing_yards), YPC = TotalRushYards/TotalRushAttempts)
```


```{r}
EveryRBReceiving<- NFLRosters %>% 
  filter(position == "RB") 
```

```{r}
All_RB_Receiving<- EveryRBReceiving %>% 
  inner_join(NFL, by=c("gsis_id" = "fantasy_player_id"))
```


```{r}
EveryRBReceiving <-All_RB_Receiving %>% 
    group_by(full_name, fantasy_data_id,position) %>% 
summarise(TotalReceivingYds = sum(receiving_yards), Avg_ReceivingYds = mean(receiving_yards), Total_AirYards= sum(air_yards), Avg_AirYards= mean(air_yards), Avg__YAC = mean (yards_after_catch), Total_YAC = sum (yards_after_catch), Avg_AirEPA = mean (air_epa), Total_AirEPA = sum(air_epa), Avg_YACEPA =mean (yac_epa), Total_YacEPA = sum(yac_epa), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_YAC_Comp = sum(comp_yac_epa), Avg_YAC_Comp = mean(comp_yac_epa), Total_YAC_WPA = sum(yac_wpa), Avg_YAC_WPA = mean(yac_wpa), TotalEPA = sum(epa), TotalYardsGained = sum(yards_gained))
```



```{r}
EveryTE<- NFLRosters %>% 
  filter(position == "TE") 
```

```{r}
All_TE <- EveryTE %>% 
  inner_join(NFL, by=c("gsis_id" = "fantasy_player_id"))
```


```{r}
EveryQB<- NFLRosters %>% 
  filter(position == "QB") 
```
```{r}
All_QB <- EveryQB %>% 
  inner_join(NFL, by=c("gsis_id" = "fantasy_player_id"))
```

```{r}
All_QB <- All_QB %>% 
    group_by(full_name, fantasy_data_id,position) %>% 
  summarise (Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_pass_touchdown = sum (pass_touchdown), Total_complete_pass = sum(complete_pass), Total_Pass_attempt = sum(pass_attempt), Interceptions = sum(interception), TotalQBEPA =sum(qb_epa), Avg_QBEPA = mean(qb_epa), Avg_pass_oe = mean(pass_oe), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum(comp_air_epa), TotalDropbacks= sum (qb_dropback))
```



```{r}
All_WR <- EveryWR %>% 
  inner_join(NFL, by=c("gsis_id" = "fantasy_player_id"))

```
```{r}
All_WR <- All_WR %>% 
  group_by(full_name, fantasy_id,position) %>% 
  rename(fantasy_player_id = fantasy_id) %>% 
  summarise(Total_AirYards= sum(air_yards), Avg_AirYards= mean(air_yards), Avg__YAC = mean (yards_after_catch), Total_YAC = sum (yards_after_catch), Avg_AirEPA = mean (air_epa), Total_AirEPA = sum(air_epa), Avg_YACEPA =mean (yac_epa), Total_YacEPA = sum(yac_epa), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_YAC_Comp = sum(comp_yac_epa), Avg_YAC_Comp = mean(comp_yac_epa), Total_YAC_WPA = sum(yac_wpa), Avg_YAC_WPA = mean(yac_wpa),TotalReceivingYds = sum(receiving_yards), Avg_ReceivingYds = mean(receiving_yards), TotalEPA = sum(epa), TotalExpectedYAC_EPA = sum (xyac_epa),AvgExpectedYAC_EPA = mean (xyac_epa), TotalYardsGained = sum(yards_gained))
```
```{r}
ggplot() + geom_point(data=All_WR, aes(x=Avg_AirEPA, y=Avg_YAC_Comp))
```
```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_AirEPA, y=Avg_comp_air_epa)) +
  geom_smooth(data=All_WR, aes(x=Avg_AirEPA, y=Avg_comp_air_epa), method="lm") +
  geom_point(data=MyWR, aes(x=Avg_AirEPA, y=Avg_comp_air_epa), color="red") 

```


```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Total_AirYards, y=TotalReceivingYds)) +
  geom_smooth(data=All_WR, aes(x=Total_AirYards, y=TotalReceivingYds), method="lm") +
  geom_point(data=MyWR, aes(x=Total_AirYards, y=TotalReceivingYds), color="red") 

```
```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds)) +
  geom_smooth(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds), method="lm") +
  geom_point(data=MyWR, aes(x=Avg_AirYards, y=Avg_ReceivingYds), color="red") 

```


```{r}
ggplot() + 
  geom_point(data=All_RB, aes(x=YPC, y=TotalRushAttempts)) +
  geom_smooth(data=All_RB, aes(x=YPC, y=TotalRushAttempts), method="lm") +
  geom_point(data=MyRB, aes(x=YPC, y=TotalRushAttempts), color="red") 

```
```{r}
ggplot() + 
  geom_point(data=EveryRBReceiving, aes(x=Avg_AirEPA, y=Avg_YAC_Comp)) +
  geom_smooth(data=EveryRBReceiving, aes(x=Avg_AirEPA, y=Avg_YAC_Comp), method="lm") +
  geom_point(data=MyRB_receiving, aes(x=Avg_AirEPA, y=Avg_YAC_Comp), color="red") 

```


```{r}
ggplot() + 
  geom_point(data=All_TE, aes(x=Avg_AirEPA, y=Avg_YAC_Comp)) +
  geom_smooth(data=All_TE, aes(x=Avg_AirEPA, y=Avg_YAC_Comp), method="lm") +
  geom_point(data=MyTEs, aes(x=Avg_AirEPA, y=Avg_YAC_Comp), color="red") 
```


```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds)) +
  geom_smooth(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds), method="lm") +
  geom_point(data=DOUBS, aes(x=Avg_AirYards, y=Avg_ReceivingYds), color="red") 

```


```{r}
DOUBS <- All_WR %>% 
  filter(full_name == "Romeo Doubs")
```

```{r}
AJ <- All_WR %>% 
  filter(full_name == "A.J. Brown")
```
```{r}
Chase <- All_WR %>% 
  filter(full_name == "Ja'Marr Chase")
```


Ja'Marr Chase

```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds)) +
  geom_smooth(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds), method="lm") +
  geom_point(data=AJ, aes(x=Avg_AirYards, y=Avg_ReceivingYds), color="red") 

```

```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds)) +
  geom_smooth(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds), method="lm") +
  geom_point(data=Chase, aes(x=Avg_AirYards, y=Avg_ReceivingYds), color="red") 

```

Justin Jefferson

```{r}
Jetts <- All_WR %>% 
  filter(full_name == "Justin Jefferson")
```


```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds)) +
  geom_smooth(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds), method="lm") +
  geom_point(data=Jetts, aes(x=Avg_AirYards, y=Avg_ReceivingYds), color="red") 

```
```{r}
Gabe <- All_WR %>% 
  filter(full_name == "Gabe Davis")
```
Gabe Davis
```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds)) +
  geom_smooth(data=All_WR, aes(x=Avg_AirYards, y=Avg_ReceivingYds), method="lm") +
  geom_point(data=Gabe, aes(x=Avg_AirYards, y=Avg_ReceivingYds), color="red") 

```
```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_YACEPA, y=Avg_AirEPA)) +
  geom_smooth(data=All_WR, aes(x=Avg_YACEPA, y=Avg_AirEPA), method="lm") +
  geom_point(data=Chase, aes(x=Avg_YACEPA, y=Avg_AirEPA), color="red") 

```

```{r}
Jeudy <- All_WR %>% 
  filter(full_name == "Jerry Jeudy")
```

```{r}
ggplot() + 
  geom_point(data=All_WR, aes(x=Avg_YACEPA, y=Avg_AirEPA)) +
  geom_smooth(data=All_WR, aes(x=Avg_YACEPA, y=Avg_AirEPA), method="lm") +
  geom_point(data=Jeudy, aes(x=Avg_YACEPA, y=Avg_AirEPA), color="red") 

```

```{r}
ggplot() + 
  geom_lollipop(
    data=All_WR, 
    aes(y=reorder(full_name, TotalEPA), x=TotalEPA), 
    horizontal = TRUE
    ) + 
  geom_lollipop(
    data=MyWR,
    aes(y=full_name, x=TotalEPA),
    horizontal = TRUE,
    color = "red"
  ) + 
  theme_minimal() + 
  labs(title = "All Season WR Total EPA", y="Receiver")
```
```{r}
WREPA<- All_WR %>% 
  group_by(full_name) %>% 
  summarise(TotalEPA, Total_AirEPA, TotalExpectedYAC_EPA, AvgExpectedYAC_EPA, TotalReceivingYds)
```

```{r}
My_WR_Targets <- NFL %>%
  filter(!is.na(receiver_player_name)) %>% 
  group_by(receiver_player_id, receiver_player_name, complete_pass) %>% 
  summarise(count = n()) %>% 
  pivot_wider(names_from = complete_pass, values_from = count) %>% 
  rename(receptions = `1`, incompletions = `0`) %>% 
  mutate(receptions = replace_na(receptions, 0), incompletions = replace_na(incompletions, 0)) %>% 
  mutate(targets = receptions + incompletions) %>% 
  inner_join(MyWR, by=c("receiver_player_id"="fantasy_player_id"))
```
```{r}
WR_Targets <- NFL %>%
  filter(!is.na(receiver_player_name)) %>% 
  group_by(receiver_player_id, receiver_player_name, complete_pass) %>% 
  summarise(count = n()) %>% 
  pivot_wider(names_from = complete_pass, values_from = count) %>% 
  rename(receptions = `1`, incompletions = `0`) %>% 
  mutate(receptions = replace_na(receptions, 0), incompletions = replace_na(incompletions, 0)) %>% 
  mutate(targets = receptions + incompletions) %>% 
  inner_join(All_WR, by=c("receiver_player_id"="fantasy_player_id"))
```


```{r}
All_TE <- All_TE %>% 
    group_by(full_name, fantasy_data_id,position) %>%
  summarise(Total_AirYards= sum(air_yards), Avg_AirYards= mean(air_yards), Avg__YAC = mean (yards_after_catch), Total_YAC = sum (yards_after_catch), Avg_AirEPA = mean (air_epa), Total_AirEPA = sum(air_epa), Avg_YACEPA =mean (yac_epa), Total_YacEPA = sum(yac_epa), Avg_comp_air_epa = mean(comp_air_epa), Total_comp_air_epa = sum (comp_air_epa), Total_YAC_Comp = sum(comp_yac_epa), Avg_YAC_Comp = mean(comp_yac_epa), Total_YAC_WPA = sum(yac_wpa), Avg_YAC_WPA = mean(yac_wpa),TotalReceivingYds = sum(receiving_yards), Avg_ReceivingYds = mean(receiving_yards))
```